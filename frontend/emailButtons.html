<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="styles.css" />
		<title>Purchase Image</title>
	</head>
	<body>
		<div class="notEffectedContainer">
			<a href="index.html" class="notEffected"
				><button>Back to Upload Photos Page</button></a
			>
		</div>
		<center>
			<img src="" alt="" width="500px" id="originalImage" />
		</center>
		<br />
		<center>Photo '<span id="photoName"></span>'</center>
		<br />
		<h1>Approve or Reject the Photo Purchase</h1>
		<button class="test" onclick="sendAction('Approve Purchase')">
			Approve
		</button>
		<button onclick="sendAction('Reject Purchase')">Reject</button>

		<script>
			const currentURL = new URL(window.location.href);
			const imgPath = currentURL.searchParams.get("imgPath");
			const photoName = currentURL.searchParams.get("photoName");
			document.querySelector("#originalImage").src = imgPath;
			document.querySelector("#photoName").textContent = photoName;

			function sendAction(action) {
				fetch("/mail/send", {
					method: "POST",
					headers: {
						"Content-Type": "application/json",
					},
					body: JSON.stringify({ action, photoName }),
				})
					.then((response) => {
						if (response.ok) {
							alert("Email sent successfully!");
						} else {
							alert("Failed to send email.");
						}
					})
					.catch((error) => console.error("Error:", error));
			}
		</script>
	</body>
</html>
